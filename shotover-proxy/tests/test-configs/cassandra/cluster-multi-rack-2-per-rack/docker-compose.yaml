version: "3.3"
networks:
  cluster_subnet:
    name: cluster_subnet
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.16.1.0/24
          gateway: 172.16.1.1

services:
  cassandra1_1:
    image: &image shotover/cassandra-test:4.0.6-r1
    networks:
      cluster_subnet:
        ipv4_address: 172.16.1.2
    environment: &environment
      CASSANDRA_SEEDS: "cassandra1_1,cassandra1_2,cassandra2_1,cassandra2_2,cassandra3_1,cassandra3_2"
      CASSANDRA_CLUSTER_NAME: TestCluster
      CASSANDRA_RACK: rack1
      CASSANDRA_DC: datacenter1
      CASSANDRA_ENDPOINT_SNITCH: GossipingPropertyFileSnitch
      CASSANDRA_INITIAL_TOKENS: -1581530985297236285,-2672828095989448545,-3768869996224386834,-5547504297047973963,-6525649749564088038,-737154337806074529,-8144673045261131336,1774614508436541522,2792465913178968537,3610137845791319332,4685893727016898871,5421809419727792512,6501182227175394170,703113892096508709,7744702232855986142,8712066475934521641
      MAX_HEAP_SIZE: "400M"
      MIN_HEAP_SIZE: "400M"
      HEAP_NEWSIZE: "48M"
    volumes: &volumes
      - type: tmpfs
        target: /var/lib/cassandra
  cassandra1_2:
    image: *image
    networks:
      cluster_subnet:
        ipv4_address: 172.16.1.3
    environment:
      <<: *environment
      CASSANDRA_RACK: rack1
      CASSANDRA_INITIAL_TOKENS: -1498046278553887682,-2233961971264781322,-3309717852490360862,-4127389785102711656,-418673471106286025,-5145241189845138672,-6216741806185171484,-7657010036087754724,-8501386683578916482,1792210777652841446,3382215330166740084,5001238625863783381,5979384078379897457,7758018379203484585,824846534574305947,8854060279438422874
    volumes: *volumes

  cassandra2_1:
    image: *image
    networks:
      cluster_subnet:
        ipv4_address: 172.16.1.5
    environment:
      <<: *environment
      CASSANDRA_RACK: rack2
      CASSANDRA_INITIAL_TOKENS: -113196755271768530,-1209238655506706819,-2987872956330293948,-3966018408846408023,-5585041704543451321,-7175046257057349959,-8142410500135885458,1822477002911605486,3262745232814188724,4334245849154221537,5352097253896648552,6169769186508999347,7245525067734578886,7981440760445472527,9060813567893074185,978100355420443729
    volumes: *volumes
  cassandra2_2:
    image: *image
    networks:
      cluster_subnet:
        ipv4_address: 172.16.1.6
    environment:
      <<: *environment
      CASSANDRA_RACK: rack2
      CASSANDRA_INITIAL_TOKENS: -1332542431349867968,-2576062437030459942,-365178188271332470,-3655435244478061599,-4391350937188955240,-5467106818414534780,-6284778751026885574,-7302630155769312590,-8374130772109345403,1224826364242566167,2843849659939609464,3821995112455723540,5600629413279310668,6696671313514248957,7787968424206461216,8632345071697622974
    volumes: *volumes

  cassandra3_1:
    image: *image
    networks:
      cluster_subnet:
        ipv4_address: 172.16.1.8
    environment:
      <<: *environment
      CASSANDRA_RACK: rack3
      CASSANDRA_INITIAL_TOKENS: -1219526640376827828,-2197672092892941903,-3816695388589985200,-5406699941103883838,-6374064184182419337,-7617584189863011311,-8696956997310612969,1655149560681697589,2746446671373909848,3590823318865071605,5031091548767654843,559107660446759300,6102592165107687656,7120443569850114671,7938115502462465466,9013871383688045005
    volumes: *volumes
  cassandra3_2:
    image: *image
    networks:
      cluster_subnet:
        ipv4_address: 172.16.1.9
    environment:
      <<: *environment
      CASSANDRA_RACK: rack3
      CASSANDRA_INITIAL_TOKENS: -2403785647040412411,-3248162294531574167,-4339459405223786427,-5435501305458724716,-7214135606282311845,-8192281058798425921,-963517417137829172,107983199202203640,1125834603944630655,1943506536556981450,3019262417782560989,3755178110493454630,4834550917941056288,6078070923621648260,7045435166700183759,8635439719214082397
    volumes: *volumes
